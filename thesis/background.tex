\chapter{Background}
\label{ch:background}

In this chapter, we delineate the principles of contemporary naval communications, emphasizing the characteristics and deficiencies of prevailing standards (NMEA).
The subsequent discussion will address the necessity for "software-defined networking" and the innovative technologies underpinning network administration, EBPF and AFXDP.


\section{Naval Networks}\label{sec:naval_networking_and_nmea}

A naval network, otherwise referred to as an \textbf{integrated shipboard communication system} is a sophisticated and meticulously organized system designed to facilitate communication, data exchange, and operational coordination whithin subsystems and devices on the vessel. 
Given the numerous elements that contribute to the ship's apparatus, such as navigation systems, sensors, monitoring systems, and combat-management systems, our focus will be directed exclusively towards the communication limb that directly interests our final goal.

\subsection{Communication systems}
Communication systems facilitate seamless communication of the vessel both internally and externally ensuring the continuous exchange of data.
The field of external communication can be subdivided into three primary categories :

\begin{itemize}
    \item\textbf{Command and Control (C2)},for long-range capabilities such as communication with shore-based command centers, other ships and aircrafts
    \item\textbf{Tactical Coordination}, for short-to-medium range communication which are critical for coordination and emergency communications
    \item\textbf{Emergency Communication},for real time data exchange among various components allowing coordinated operations among ships, aircrafts and ground forces
\end{itemize}

External side communication's capstone can be identified in the usage of the Satellite Communication (SATCOM) protocol that enables beyond-line-of-sight (BLOS) data exchange providing global, high-bandwidth, and secure connectivity. However, it is part of a broader ecosystem that includes radio communication, tactical data links, and underwater communication systems.\\
Internal communication, on the other hand, although it comprises crew coordination systems the main body consists of devices that provide a unified picture among navigation, propulsion, combat, and management environments. Vessels are designed to establish an informational circulatory system within them that consists of a physical apparatus composed of various components such as switches, routers, gateways, and servers. The flow of information within it falls into five distinct categories: 

\begin{itemize}
    \item\textbf{Navigation and Situational Awareness}, data transmitted over the network and integrated into the Combat Management System, providing a real-time operational picture
    \item\textbf{Threat Detection and Response}, data signaling potential threats coming from the sensoring systems
    \item\textbf{Engine Monitoring and Control}, data allowing the crew to monitor and optimize the ship's propulsion and power systems
    \item\textbf{Crew Communication}, intercom system's data to coordinate crew actions during missions
    \item\textbf{Cybersecurity Monitoring}, cybersecurity systems data that ensure integrity and safety of the ship
\end{itemize}

\subsection{NMEA}

Given the wide range of the aforementioned messages in the early years of 1980 the \textbf{National Marine Electronics Association (NMEA)} introduced the first kind of protocol to standardize communication for marine electronics.
Since its inception, the protocol has evolved significantly to accommodate advancements in technology and the expanding needs of different industries.

\subsubsection*{NMEA 0183}
The protocol underwent a series of modifications, beginning with the 0180 and 0182 versions. However, these initial implementations were swiftly discarded in favor of the subsequent iteration, the 0183. This new version's adoption as the primary standard for serial communications can be attributed to its simplicity and comprehensive functionality, providing the vessel's components a complete overview of other one's status through simple text.

This standard utilizes a rudimentary ASCII serial communications protocol, which delineates a method where data are transmitted in a \textbf{sentence} from a single \textbf{talker} to multiple \textbf{listeners} concurrently. The protocol enables a talker to engage in a unidirectional conversation with an almost limitless number of listeners by employing intermediate expanders, and it facilitates communication between multiple sensors and a singular port through the use of multiplexers.  

Although the protocol stipulates the use of RS-422 for electrical transport, a de facto standard has emerged in which sentences are \textbf{encapsulated in UDP datagrams} and \textbf{transmitted over IP networks}.

\paragraph{Message structure}
\leavevmode\newline\\
    All messages must be composed of printable ASCII characters between \textit{0x20} (space) to \textit{0x7e} (tilde) including a set of special characters that define the syntax
    
\begin{tabularx}{\textwidth}{|>{\hsize=0.5\hsize}X|>{\hsize=0.5\hsize}X|>{\hsize=1\hsize}X|}
  \hline
  \multicolumn{3}{|c|}{\textbf{Syntax characters}} \\ \hline
  ASCII & HEX & USE \\ \hline
  \textless CR\textgreater  &  0x0d   & Carriage return        \\ \hline
  \textless LF\textgreater   & 0x0a    & Line feed, end delimiter       \\ \hline
  !    & 0x21   &   Start of encapsulation sentence delimiter   \\ \hline
  \textdollar     & 0x24   & Start delimiter      \\ \hline
  *    & 0x2a    & Checksum delimiter     \\ \hline
  ,    & 0x2c   & Field delimiter       \\ \hline
  \textbackslash     & 0x5c   & TAG block delimiter        \\ \hline
  \textasciicircum    & 0x5e     & Code delimiter for HEX representation of ISO/IEC 8859-1 (ASCII) characters     \\ \hline
  \textasciitilde     & 0x7e    & Reserved       \\ \hline
\end{tabularx}

\leavevmode\newline\\
Moreover, adherence to established syntax rules is imperative for the purpose of ensuring compliance with the protocol, in particular :

\begin{itemize}
    \item Messages have a maximum length of 82 characters, including the \textdollar \ or ! starting character and the ending \textless LF\textgreater
    \item The start character for each message can be either a \textdollar (For conventional field delimited messages) or ! (for messages that have special encapsulation in them)
    \item The next five characters identify the \textbf{Talker Id} (two characters) and the \textbf{Sentence Type} (three characters)
    \item All data fields that follow are comma-delimited
    \item Where data is unavailable, the corresponding field remains blank (it contains no character before the next delimiter
    \item The first character that immediately follows the last data field character is an asterisk, but it is only included if a checksum is supplied
    \item The asterisk is immediately followed by a checksum represented as a two-digit hexadecimal number. The checksum is the bitwise exclusive OR of ASCII codes of all characters between the \textdollar \ and *, not inclusive.
    \item \textless CR\textgreater \textless LF\textgreater \ ends the message
\end{itemize}

The following is a list of the most common messages that appeared in the early days of this technology, constituting the first kind of standardized communication:
\leavevmode\newline\

\begin{tabularx}{\textwidth}{|>{\hsize=0.75\hsize}X|>{\hsize=1.25\hsize}X|}
  \hline
  \multicolumn{2}{|c|}{\textbf{NMEA 0183 Common Sentences}} \\ \hline
  Sentence Type & Description \\ \hline
   \textdollar Talker ID+GGA  & Global Positioning System Fixed Data         \\ \hline
   \textdollar Talker ID+GLL    & Geographic Positionâ€”Latitude and Longitude       \\ \hline
  \textdollar Talker ID+GSA   &   GNSS DOP and active satellites    \\ \hline
   \textdollar Talker ID+GSV  & GNSS satellites in view      \\ \hline
   \textdollar Talker ID+RMC   & Recommended minimum specific GPS data     \\ \hline
   \textdollar Talker ID+VTG   & Course over ground and ground speed      \\ \hline
\end{tabularx}

\paragraph{Protocol security}

\leavevmode\newline\\

The protocol's conception predates the conceptualization of vehicle hacking, thus lacking any inherent security measures to protect network information flows from potential attacks.
To date, the research community has conducted only a limited number of studies on the security of network marine protocols. Moreover, there is a paucity of research on risk analysis for this type of communication.

As is the case with other networking protocols, marine protocols are susceptible to malicious attacks and unintentional human errors. It is incumbent upon manufacturers to consider the extended Confidentiality, Integrity, and Availability (CIA) model, which encompasses Authentication, Authorization, and Non-repudiation from the creation to implementation and maintenance of network device firmware. 

As of the present date, only naive solutions have been implemented in order to address these primary security concerns :

\begin{itemize}

    \item\textbf{Confidentiality} : Due to the limitation of bandwidth in many marine network protocols, encryption mechanisms are not implemented. Consequently, the predominant approach to ensure confidentiality for these systems is primarily through access control.
    
    \item\textbf{Integrity} : Vessels generate substantial surges in network traffic, which often surpasses the bandwidth capacity of the ship. This phenomenon can result in service disruptions and latency as various services compete for bandwidth. One proposed solution to this challenge is the implementation of a master device in conjunction with multiple remote devices. In instances where a high-priority bandwidth requirement is identified, a remote device can be temporarily allocated to an auxiliary channel, thereby facilitating the management of network traffic.
    
    \item\textbf{Availability} : The majority of maritime communication protocols are designed to support slow transfer speeds. Therefore, the protection for availability is contingent upon the hardware specification and configuration, allowing for data transfer at the maximum data rate of the protocol. In the context of critical systems that necessitate uninterrupted accessibility, the implementation of hardware redundancy and backup mechanisms becomes imperative.

    \item\textbf{Authentication} : A select number of shipping protocols incorporate optional authentication mechanisms that are not specialized for the protocols themselves. These include the Global Navigation Satellite System (GNSS) and systems adopted from vehicular networks. Consequently, under theory, these protocols possess the potential to be adapted to support authentication for marine networks; however, this functionality is not currently available.

    \item\textbf{Authorization} : A considerable number of protocols incorporate a form of an ID tag to identify the communication nodes, along with their privileges, as well as access rights, inside a network. However, in the absence of adequate inspection mechanisms, a malicious device can potentially generate its own ID with a high level of authorization, thereby circumventing access controls and gaining unauthorized access to sensitive information. 

    \item\textbf{Non-Repudiation} : This concern has witnessed a marked rise in prominence, particularly in the context of forensics and legal challenges. Non-repudiation is poised to assume greater significance; however, at present, no non-repudiation technique has been implemented in any substantial manner.
    
\end{itemize}

As the protocol undergoes continuous development and enhancement, \textbf{theoretical analyses} were conducted to evaluate the current state of data exchange security in response to prevalent attacks. The objective of this endeavor was to identify vulnerabilities that could be exploited by an attacker to compromise the protocol.
The subsequent list of attacks is not intended to be exhaustive; rather, it is designed to illustrate the most critical violations that can be perpetrated in networks that utilize the protocol:

\begin{itemize}
    \item\textbf{Denial of Service (DoS)}: targets the availability of data
    \item\textbf{Spoofing}: targets the integrity of data.
    \item\textbf{Packet sniffing}: targets the confidentiality of data.
    \item\textbf{Replay/Man-in-the-Middle (MITM)}: targets both confidentiality and integrity of data.
\end{itemize}

It is important to note that the NMEA 0183 protocol does not incorporate any mechanisms for authentication, encryption, or validation. The absence of security measures inherent to the protocol renders it vulnerable to any of the aforementioned attack if utilized effectively by an adversary

\leavevmode\newline\\

\begin{tabularx}{\textwidth}{|>{\hsize=0.75\hsize}X|>{\hsize=1.25\hsize}X|}
  \hline
  \multicolumn{2}{|c|}{\textbf{Possible attacks against the NMEA 0183 protocol}} \\ \hline
  Attack & Methodology \\ \hline
    Denial of Service & NMEA 0183 supports a baud rate of 4800 (9600 bits/s). This makes a DoS attack potentially effective against any devices using this protocol depending on the means through which data is transferred to an application \\ \hline
    Spoofing/Packet Sniffing   & Spoofing and sniffing has been shown to be trivial against the standard using simple traffic simulation software     \\ \hline
    Replay/Man-in-the-Middle &  Leveraging software that that intercepts and manipulates data exchanged modifiying critical missions' informations such as coordinates coming from sensor devices  \\ \hline
\end{tabularx}

\subsubsection{NMEA 2000}
The fourth iteration of the protocol resulted in a more advanced implementation, characterized by more sophisticated structural choices that increased performance. Regrettably, the security standards remained unaltered.

\paragraph{Key changes from NMEA 0183}
\leavevmode\newline

The backbone of this new version's enhancements can be identified in the standard communication being based on the \textbf{Controller Area Network (CAN)} Bus protocol.
CAN protocol utilizes a message-based architecture and is capable of operating at either 512 Kbps or 128 Kbps. Each device that transmits CAN Bus signals is considered a node, each one with a priority level.

During transmission, nodes continuously check the signal on the bus and compares
it with the signal it is transmitting. If a mismatch occurs, an error is raised and the internal error counter is incremented to prevent having broken nodes continuously flooding the network.
The right of a node to raise errors can be disabled depending on the value of these counters granting that communication over CAN Bus is reliable.

Data messages are transmitted as a series of data frames that incorporate robust error
checking, confirmed frame delivery and guaranteed latency times.

\subsubsection{NMEA OneNet}


\subsubsection{Considerations over the standards}
NMEA 0183 and NMEA 2000 are the main standards widely
accepted by manufacturers and maritime agencies worldwide, and they receive frequent
updates. However,
\section{Software Defined Networking - SDN}

%\begin{figure}
	%\centering\includegraphics[scale=0.7]{images/directivity}
	%\caption{Directivity of a parabolic reflector antenna for $\theta = \frac{\pi}{2}$.
	%The angle is $\phi$, while the distance is the directivity expressed in
	%decibels.}\label{fig:directivity}
%\end{figure}

